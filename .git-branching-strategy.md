# Git Branching Strategy

## Overview

This document outlines the Git branching strategy for Mero Jugx project. The strategy ensures code quality, enables controlled releases, and maintains a clean production environment.

## Branch Hierarchy

```
main (Production - Protected)
  └── version-control (Release Branch - Protected)
        └── develop (Development Integration)
              ├── feature/feature-name
              ├── bugfix/bug-name
              └── hotfix/hotfix-name
```

## Branch Descriptions

### 1. `main` Branch (Production)

**Purpose**: Production-ready code that is deployed to live servers.

**Access**: 
- **Restricted** - Only authorized personnel can merge to main
- Requires approval from project maintainers
- Protected branch with strict rules

**Rules**:
- ✅ Can only receive merges from `version-control` branch
- ✅ No direct commits allowed
- ✅ Requires pull request review
- ✅ All CI/CD checks must pass
- ✅ Must be tested in staging environment first
- ❌ Never push directly to main
- ❌ Never create branches from main (except hotfixes)

**Merge Process**:
1. Code must be in `version-control` branch first
2. Create PR from `version-control` to `main`
3. Get approval from authorized maintainers
4. All tests must pass
5. Deploy to production after merge

### 2. `version-control` Branch (Release Branch)

**Purpose**: Staging area for code that is ready for production release.

**Access**:
- **Protected** - Requires pull request to merge
- All developers can push to this branch via PR
- CI/CD runs on this branch

**Rules**:
- ✅ Can receive merges from `develop` branch
- ✅ Can receive merges from `feature/*` branches (for urgent features)
- ✅ Requires pull request review
- ✅ All CI/CD checks must pass
- ✅ Should be stable and tested
- ❌ No direct commits (use PRs)
- ❌ Should not contain experimental code

**Merge Process**:
1. Code must be in `develop` branch first
2. Create PR from `develop` to `version-control`
3. Get code review approval
4. All tests must pass
5. Merge to `version-control`
6. Test in staging environment
7. Create PR to `main` when ready for production

### 3. `develop` Branch (Development Integration)

**Purpose**: Integration branch for all development work.

**Access**:
- **Open** - All developers can push
- Main working branch for daily development

**Rules**:
- ✅ Can receive merges from `feature/*` branches
- ✅ Can receive merges from `bugfix/*` branches
- ✅ Can receive merges from `hotfix/*` branches
- ✅ Should be kept stable
- ✅ Regular merges from feature branches
- ❌ Should not contain broken code
- ❌ Should not be directly deployed

**Merge Process**:
1. Complete feature/bugfix in branch
2. Create PR from branch to `develop`
3. Get code review
4. All tests pass
5. Merge to `develop`

### 4. Feature Branches (`feature/*`)

**Purpose**: Development of new features.

**Naming**: `feature/description-of-feature`
- Example: `feature/user-profile-page`
- Example: `feature/payment-gateway-integration`

**Rules**:
- ✅ Created from `develop`
- ✅ Merged back to `develop`
- ✅ Can be merged to `version-control` if urgent (with approval)
- ✅ Should be kept up to date with `develop`
- ❌ Should not be merged to `main` directly

**Lifecycle**:
1. Create from `develop`: `git checkout develop && git pull && git checkout -b feature/name`
2. Develop feature
3. Create PR to `develop`
4. After merge, delete branch

### 5. Bugfix Branches (`bugfix/*`)

**Purpose**: Fixing bugs found in development.

**Naming**: `bugfix/description-of-bug`
- Example: `bugfix/login-authentication-error`
- Example: `bugfix/payment-calculation-issue`

**Rules**:
- ✅ Created from `develop`
- ✅ Merged back to `develop`
- ✅ Should include tests
- ✅ Should reference issue number

**Lifecycle**:
1. Create from `develop`: `git checkout develop && git pull && git checkout -b bugfix/name`
2. Fix bug and add tests
3. Create PR to `develop`
4. After merge, delete branch

### 6. Hotfix Branches (`hotfix/*`)

**Purpose**: Critical fixes for production issues.

**Naming**: `hotfix/description-of-fix`
- Example: `hotfix/security-patch`
- Example: `hotfix/critical-payment-issue`

**Rules**:
- ✅ Created from `main`
- ✅ Merged to both `main` and `develop`
- ✅ Should be minimal and focused
- ✅ Requires urgent review
- ✅ Can bypass normal process for critical issues

**Lifecycle**:
1. Create from `main`: `git checkout main && git pull && git checkout -b hotfix/name`
2. Fix issue
3. Create PR to `main` (urgent review)
4. After merge to `main`, merge to `develop`
5. Delete branch

## Workflow Examples

### Normal Feature Development

```bash
# 1. Start from develop
git checkout develop
git pull origin develop

# 2. Create feature branch
git checkout -b feature/new-dashboard

# 3. Develop feature
# ... make changes ...
git add .
git commit -m "feat(dashboard): add new analytics section"

# 4. Push and create PR
git push origin feature/new-dashboard
# Create PR: feature/new-dashboard -> develop

# 5. After PR is merged, update local
git checkout develop
git pull origin develop
git branch -d feature/new-dashboard
```

### Release Process

```bash
# 1. Ensure develop is stable
git checkout develop
git pull origin develop

# 2. Create PR: develop -> version-control
# Review and merge

# 3. Test in staging (version-control branch)

# 4. When ready for production, create PR: version-control -> main
# Get approval from maintainers
# Merge to main
# Deploy to production
```

### Hotfix Process

```bash
# 1. Create hotfix from main
git checkout main
git pull origin main
git checkout -b hotfix/critical-security-fix

# 2. Fix issue
# ... make changes ...
git add .
git commit -m "fix(security): patch critical vulnerability"

# 3. Push and create PR to main (urgent)
git push origin hotfix/critical-security-fix
# Create PR: hotfix/critical-security-fix -> main

# 4. After merge to main, merge to develop
git checkout develop
git pull origin develop
git merge main
git push origin develop

# 5. Delete hotfix branch
git branch -d hotfix/critical-security-fix
git push origin --delete hotfix/critical-security-fix
```

## Branch Protection Rules

### Main Branch
- ✅ Require pull request reviews (2 approvals)
- ✅ Require status checks to pass
- ✅ Require branches to be up to date
- ✅ Restrict who can push (maintainers only)
- ✅ Do not allow force pushes
- ✅ Do not allow deletions

### Version-Control Branch
- ✅ Require pull request reviews (1 approval)
- ✅ Require status checks to pass
- ✅ Require branches to be up to date
- ❌ Allow force pushes (for emergency fixes only)
- ❌ Do not allow deletions

### Develop Branch
- ✅ Require pull request reviews (1 approval)
- ✅ Require status checks to pass
- ❌ Allow force pushes (use with caution)
- ❌ Do not allow deletions

## Commit Message Convention

Follow [Conventional Commits](https://www.conventionalcommits.org/):

```
<type>(<scope>): <subject>

<body>

<footer>
```

**Types**:
- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation changes
- `style`: Code style changes
- `refactor`: Code refactoring
- `test`: Adding or updating tests
- `chore`: Maintenance tasks
- `perf`: Performance improvements
- `ci`: CI/CD changes

**Examples**:
```bash
feat(payments): add Stripe payment gateway integration
fix(auth): resolve JWT token expiration issue
docs(readme): update setup instructions
refactor(users): simplify user service logic
```

## Best Practices

1. **Keep Branches Small**: One feature/bugfix per branch
2. **Regular Updates**: Keep feature branches updated with develop
3. **Clear Commit Messages**: Use conventional commit format
4. **Test Before PR**: Run tests locally before creating PR
5. **Review Before Merge**: Always get code review before merging
6. **Delete After Merge**: Delete merged branches to keep repo clean
7. **Document Changes**: Update documentation with code changes
8. **Tag Releases**: Tag main branch with version numbers

## Version Tagging

When releasing to production:

```bash
# Tag the release
git checkout main
git pull origin main
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0
```

## Emergency Procedures

### Critical Production Issue

1. Create hotfix branch from main
2. Fix issue immediately
3. Create urgent PR to main
4. Get expedited review
5. Merge and deploy
6. Merge to develop and version-control

### Broken Develop Branch

1. Identify the breaking commit
2. Revert the commit or create fix branch
3. Merge fix to develop
4. Notify team

## Questions?

If you have questions about the branching strategy:
1. Check this document
2. Ask in team chat
3. Contact project maintainers

---

**Last Updated**: 2025-01-22

**Maintained by**: Development Team

